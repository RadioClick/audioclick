<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Audio Click â€“ MedellÃ­n</title>

<style>
/* === TU CSS ORIGINAL (NO TOCADO) === */
/* (AquÃ­ va exactamente el CSS que ya tenÃ­as) */
</style>
</head>

<body>

<!-- HEADER -->
<header class="header">
  <img src="botero.jpg" class="logo" alt="Radio Click">
</header>

<!-- CONTENEDOR PRINCIPAL -->
<main class="container">

  <!-- INDICADORES -->
  <section class="stats">
    ğŸ“» Oyentes <span id="listeners">110.258</span><br>
    ğŸ“§ Suscritos <span id="subscribers">52.437</span><br>
    ğŸ‘ <span id="likeCount">10.511</span>
    ğŸ‘ <span id="dislikeCount">541</span>
  </section>

  <!-- PLAYER -->
  <section class="player">
    <button onclick="togglePlay()" id="playBtn">
      <span id="playIcon">â–¶ï¸</span> UNIRSE AL DIRECTO
    </button>

    <div class="progress-bar" onclick="seek(event)">
      <div id="progressFill"></div>
    </div>

    <div class="time">
      <span id="currentTime">0:00</span> /
      <span id="duration">60:00</span>
    </div>

    <div class="volume">
      <span class="volume-icon" onclick="toggleMute()">ğŸ”Š</span>
      <input type="range" min="0" max="100" value="70"
        onchange="changeVolume(this.value)">
    </div>
  </section>

  <!-- COMENTARIOS -->
  <section id="commentsContainer" class="comments"></section>

  <!-- WHATSAPP -->
  <footer onclick="shareWhatsApp()" class="share">
    radioclick.github.io/audioclick/
  </footer>

</main>

<audio id="mainAudio" preload="none"></audio>

<script>
// AUDIO EMBEBIDO
// PLAYLIST DE 10 ARCHIVOS MP3
const playlist = ['capsula1.mp3','capsula2.mp3','capsula3.mp3','capsula4.mp3','capsula5.mp3','capsula6.mp3','capsula7.mp3','capsula8.mp3','capsula9.mp3','capsula10.mp3'];
let currentTrack = 0;

// ELEMENTOS
const audio = document.getElementById('mainAudio');
let isSubscribed = false;
let hasLiked = false;
let hasDisliked = false;
let isMuted = false;

// Cargar audio con autoplay
audio.src = playlist[currentTrack];
audio.volume = 0.7;

// Loop infinito entre canciones
audio.addEventListener('ended', () => { 
  currentTrack = (currentTrack + 1) % playlist.length; 
  audio.src = playlist[currentTrack]; 
  audio.play(); // Reproducir automÃ¡ticamente la siguiente
});

// AUTOPLAY al cargar la pÃ¡gina
window.addEventListener('load', () => {
  audio.play().catch(err => {
    console.log('Autoplay bloqueado - usuario debe dar click en play');
  });
});

// FIREBASE CONFIG
const FIREBASE_URL = 'https://radio-click-default-rtdb.firebaseio.com/counters.json';

// CONTADORES
async function fetchGlobalCounts() {
  try {
    const response = await fetch(FIREBASE_URL, { method: 'GET' });
    if (response.ok) {
      const data = await response.json();
      return {
        listeners: data?.listeners || 10234,
        subscribers: data?.subscribers || 1429,
        likes: data?.likes || 1500,
        dislikes: data?.dislikes || 40
      };
    }
  } catch (error) {
    console.log('ğŸ“¡ Sin conexiÃ³n - modo offline');
  }
  return null;
}

async function updateGlobalCounts(listeners, subscribers, likes, dislikes) {
  try {
    await fetch(FIREBASE_URL, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        listeners, subscribers, likes, dislikes,
        lastUpdate: Date.now()
      })
    });
  } catch (error) {
    console.log('ğŸ“¡ Modo offline');
  }
}

async function initializeCounters() {
  const globalCounts = await fetchGlobalCounts();
  let listeners, subscribers, likes, dislikes;
  const isOnline = globalCounts !== null;

  if (isOnline) {
    listeners = globalCounts.listeners;
    subscribers = globalCounts.subscribers;
    likes = globalCounts.likes;
    dislikes = globalCounts.dislikes;
    localStorage.setItem('lastListeners', listeners);
    localStorage.setItem('lastSubscribers', subscribers);
    localStorage.setItem('lastLikes', likes);
    localStorage.setItem('lastDislikes', dislikes);
    localStorage.setItem('lastSync', Date.now());
  } else {
    const lastListeners = localStorage.getItem('lastListeners');
    const lastSync = localStorage.getItem('lastSync');
    
    if (lastListeners) {
      const hoursSinceSync = lastSync ? (Date.now() - parseInt(lastSync)) / (1000 * 60 * 60) : 0;
      const growth = Math.floor(hoursSinceSync * (Math.random() * 10 + 5));
      listeners = parseInt(lastListeners) + growth;
      subscribers = parseInt(localStorage.getItem('lastSubscribers')) + Math.floor(growth * 0.2);
      likes = parseInt(localStorage.getItem('lastLikes')) + Math.floor(growth * 0.15);
      dislikes = parseInt(localStorage.getItem('lastDislikes')) + Math.floor(growth * 0.01);
    } else {
      listeners = 110245;
      subscribers = 21432;
      likes = 10503;
      dislikes = 541;
    }
  }

  // Incremento por visita
  const listenersIncrease = Math.floor(Math.random() * 6) + 10;
  const subscribersIncrease = Math.floor(Math.random() * 4) + 2;
  const likesIncrease = Math.floor(Math.random() * 6) + 3;
  const dislikesIncrease = Math.floor(Math.random() * 3);
  
  listeners += listenersIncrease;
  subscribers += subscribersIncrease;
  likes += likesIncrease;
  dislikes += dislikesIncrease;

  updateDisplay(listeners, subscribers, likes, dislikes);
  localStorage.setItem('listenerCount', listeners);
  localStorage.setItem('subscriberCount', subscribers);
  localStorage.setItem('likeCount', likes);
  localStorage.setItem('dislikeCount', dislikes);

  if (isOnline) {
    await updateGlobalCounts(listeners, subscribers, likes, dislikes);
    localStorage.setItem('lastListeners', listeners);
    localStorage.setItem('lastSubscribers', subscribers);
    localStorage.setItem('lastLikes', likes);
    localStorage.setItem('lastDislikes', dislikes);
    localStorage.setItem('lastSync', Date.now());
  }

  // Restaurar estados
  if (localStorage.getItem('subscribed') === 'true') {
    isSubscribed = true;
    document.getElementById('subscribeBtn').classList.add('subscribed');
    document.getElementById('subIcon').textContent = 'âœ“';
    document.getElementById('subText').textContent = 'Suscrito';
  }
  if (localStorage.getItem('liked') === 'true') {
    hasLiked = true;
    document.getElementById('likeBtn').classList.add('liked');
  }
  if (localStorage.getItem('disliked') === 'true') {
    hasDisliked = true;
    document.getElementById('dislikeBtn').classList.add('disliked');
  }
}

function updateDisplay(listeners, subscribers, likes, dislikes) {
  document.getElementById('listeners').textContent = listeners.toLocaleString('es-CO');
  document.getElementById('subscribers').textContent = subscribers.toLocaleString('es-CO');
  document.getElementById('likeCount').textContent = likes.toLocaleString('es-CO');
  document.getElementById('dislikeCount').textContent = dislikes.toLocaleString('es-CO');
}

// SUSCRIPCIÃ“N
async function subscribe() {
  const btn = document.getElementById('subscribeBtn');
  const icon = document.getElementById('subIcon');
  const text = document.getElementById('subText');

  const listeners = parseInt(document.getElementById('listeners').textContent.replace(/\./g, ''));
  let subscribers = parseInt(document.getElementById('subscribers').textContent.replace(/\./g, ''));
  const likes = parseInt(document.getElementById('likeCount').textContent.replace(/\./g, ''));
  const dislikes = parseInt(document.getElementById('dislikeCount').textContent.replace(/\./g, ''));

  if (isSubscribed) {
    // DESUSCRIBIRSE - solo resta de suscritos
    isSubscribed = false;
    btn.classList.remove('subscribed');
    icon.textContent = 'ğŸ“§';
    text.textContent = 'SuscrÃ­bete';
    subscribers--;
    localStorage.setItem('subscribed', 'false');
    showNotification('SuscripciÃ³n cancelada');
  } else {
    // SUSCRIBIRSE - solo suma a suscritos
    isSubscribed = true;
    btn.classList.add('subscribed');
    icon.textContent = 'âœ“';
    text.textContent = 'Suscrito';
    subscribers++;
    localStorage.setItem('subscribed', 'true');
    showNotification('Â¡Gracias por suscribirte! ğŸ‰');
  }

  updateDisplay(listeners, subscribers, likes, dislikes);
  localStorage.setItem('subscriberCount', subscribers);

  const globalCounts = await fetchGlobalCounts();
  if (globalCounts) {
    await updateGlobalCounts(listeners, subscribers, likes, dislikes);
  }
}

// REACCIONES
async function react(type) {
  let listeners = parseInt(document.getElementById('listeners').textContent.replace(/\./g, ''));
  const subscribers = parseInt(document.getElementById('subscribers').textContent.replace(/\./g, ''));
  let likes = parseInt(document.getElementById('likeCount').textContent.replace(/\./g, ''));
  let dislikes = parseInt(document.getElementById('dislikeCount').textContent.replace(/\./g, ''));

  if (type === 'like') {
    if (hasLiked) {
      hasLiked = false;
      likes--;
      localStorage.setItem('liked', 'false');
      document.getElementById('likeBtn').classList.remove('liked');
      showNotification('Me gusta removido');
    } else {
      if (hasDisliked) {
        hasDisliked = false;
        dislikes--;
        localStorage.setItem('disliked', 'false');
        document.getElementById('dislikeBtn').classList.remove('disliked');
      }
      hasLiked = true;
      likes++;
      localStorage.setItem('liked', 'true');
      document.getElementById('likeBtn').classList.add('liked');
      showNotification('Â¡Gracias por tu Me gusta! ğŸ‘');
    }
  } else {
    if (hasDisliked) {
      hasDisliked = false;
      dislikes--;
      localStorage.setItem('disliked', 'false');
      document.getElementById('dislikeBtn').classList.remove('disliked');
      showNotification('OpiniÃ³n removida');
    } else {
      if (hasLiked) {
        hasLiked = false;
        likes--;
        localStorage.setItem('liked', 'false');
        document.getElementById('likeBtn').classList.remove('liked');
      }
      hasDisliked = true;
      dislikes++;
      localStorage.setItem('disliked', 'true');
      document.getElementById('dislikeBtn').classList.add('disliked');
      showNotification('OpiniÃ³n registrada');
    }
  }

  updateDisplay(listeners, subscribers, likes, dislikes);
  localStorage.setItem('likeCount', likes);
  localStorage.setItem('dislikeCount', dislikes);

  const globalCounts = await fetchGlobalCounts();
  if (globalCounts) {
    await updateGlobalCounts(listeners, subscribers, likes, dislikes);
  }
}

// REPRODUCTOR
function togglePlay() {
  if (audio.paused) {
    audio.play()
      .then(() => {
        document.getElementById('playIcon').textContent = 'â¸ï¸';
      })
      .catch(err => {
        console.error('Error:', err);
        showNotification('Error al reproducir');
      });
  } else {
    audio.pause();
    document.getElementById('playIcon').textContent = 'â–¶ï¸';
  }
}

function changeVolume(value) {
  audio.volume = value / 100;
  isMuted = false;
  updateVolumeIcon();
}

function toggleMute() {
  if (isMuted) {
    audio.volume = 0.7;
    isMuted = false;
  } else {
    audio.volume = 0;
    isMuted = true;
  }
  updateVolumeIcon();
}

function updateVolumeIcon() {
  const icon = document.querySelector('.volume-icon');
  if (isMuted || audio.volume === 0) {
    icon.textContent = 'ğŸ”‡';
  } else {
    icon.textContent = 'ğŸ”Š';
  }
}

function seek(event) {
  const bar = event.currentTarget;
  const rect = bar.getBoundingClientRect();
  const percent = (event.clientX - rect.left) / rect.width;
  audio.currentTime = percent * audio.duration;
}

function formatTime(seconds) {
  if (!isFinite(seconds)) return '0:00';
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
}

// CONECTADOS AHORA (solo con internet)
let liveCount = 0;
let isOnlineGlobal = false;

function updateLiveCount() {
  if (isOnlineGlobal) {
    const baseCount = 18;
    const variation = Math.floor(Math.random() * 28) + baseCount;
    liveCount = variation;
    document.getElementById('liveNow').textContent = liveCount;
    document.getElementById('liveNowContainer').style.display = 'flex';
  } else {
    document.getElementById('liveNowContainer').style.display = 'none';
  }
}

async function checkConnection() {
  try {
    const response = await fetch(FIREBASE_URL + '?check=' + Date.now());
    isOnlineGlobal = response.ok;
  } catch (error) {
    isOnlineGlobal = false;
  }
  updateLiveCount();
}

checkConnection();
setInterval(checkConnection, 5000);
setInterval(updateLiveCount, 3000);

// COMENTARIOS EN VIVO
const commentNames = ["MarÃ­a GonzÃ¡lez", "Carlos RodrÃ­guez", "Ana MartÃ­nez", "JosÃ© LÃ³pez", "Laura FernÃ¡ndez", "Miguel Ãngel", "Carmen Silva", "Roberto DÃ­az", "Patricia Morales", "Fernando Castro", "Isabel Vargas", "Diego Ramos", "SofÃ­a Herrera", "AndrÃ©s Mendoza", "Valentina Cruz", "Juan Pablo", "Gabriela Torres", "Luis Eduardo", "Camila Rojas", "SebastiÃ¡n Ortiz", "Daniela Reyes", "Alejandro Ruiz", "Natalia JimÃ©nez", "Ricardo Vega", "Carolina Flores", "Mauricio PÃ©rez", "VerÃ³nica SÃ¡nchez", "Pablo Aguirre", "Claudia RamÃ­rez", "Javier Molina", "Sandra Ospina", "Felipe GutiÃ©rrez", "MÃ³nica RÃ­os", "Gustavo Parra", "Liliana Cardona", "RaÃºl MejÃ­a", "Gloria Salazar", "HÃ©ctor Zapata", "Beatriz MuÃ±oz", "Ã“scar Henao", "Mariana Duque", "JuliÃ¡n Arango", "Teresa GÃ³mez", "Sergio Valencia", "Adriana Betancur", "IvÃ¡n Montoya", "Cristina LondoÃ±o", "Mario SuÃ¡rez", "Paola Escobar", "Rodrigo VÃ©lez", "Amparo Giraldo", "Ãlvaro Correa", "Diana Botero", "FabiÃ¡n Uribe", "LucÃ­a Calle", "Ernesto Mesa", "Silvia ArbelÃ¡ez", "HernÃ¡n Jaramillo", "Pilar Echeverri", "Guillermo Ossa", "Yolanda Posada", "Arturo RendÃ³n", "Blanca HincapiÃ©", "Eduardo Franco", "Martha Toro", "Julio Gaviria", "Rosa Quintero", "Alfredo CastaÃ±o", "Esperanza Marulanda", "Antonio CastrillÃ³n", "Elena Arboleda", "Vicente PÃ©rez", "Miriam Soto", "Leonardo Rojas", "Cecilia Ocampo", "Francisco Villa", "InÃ©s Naranjo", "Gabriel Tamayo", "RocÃ­o MarÃ­n", "Manuel Galeano", "Olga Saldarriaga", "Pedro RincÃ³n", "Ligia AristizÃ¡bal", "RubÃ©n LÃ³pez", "Amparo Mesa", "Jaime Zapata", "Luz Marina DÃ­az", "Alberto RamÃ­rez", "Clara GonzÃ¡lez", "Jorge Castro", "Marta GÃ³mez", "Hugo FernÃ¡ndez", "Nora RodrÃ­guez", "Rafael Vargas", "Stella Morales", "Armando Sierra", "Dora JimÃ©nez", "Esteban Ruiz", "Blanca Reyes", "Camilo Ortiz"];

const commentTexts = ["Excelente informaciÃ³n, gracias Radio Click! ğŸ“»", "Muy buena transmisiÃ³n como siempre ğŸ‘", "Los escucho todos los dÃ­as, saludos desde MedellÃ­n! ğŸ™ï¸", "Gran trabajo equipo, sigan asÃ­! ğŸ’ª", "Me encanta esta emisora, muy profesional â­", "Contenido de calidad, felicitaciones! ğŸ‰", "Siempre al dÃ­a con las noticias, gracias! ğŸ“°", "La mejor radio de MedellÃ­n sin duda ğŸ”¥", "InformaciÃ³n clara y precisa, excelente! âœ…", "Los sigo desde hace meses, muy buenos! ğŸ§", "Saludos desde el centro de MedellÃ­n! ğŸ‘‹", "Me gusta mucho el formato de las cÃ¡psulas ğŸ“¡", "SÃºper Ãºtil la informaciÃ³n, gracias! ğŸ’¯", "Esperando la prÃ³xima transmisiÃ³n! â°", "Compartiendo con mis amigos ğŸ”—", "Muy profesional el contenido ğŸ¯", "Noticias actualizadas, perfecto! ğŸ“£", "Los escucho mientras trabajo, genial! ğŸ’¼", "Calidad en cada emisiÃ³n ğŸŒŸ", "Saludos desde Antioquia! ğŸ”ï¸", "Me mantienen informado siempre ğŸ“²", "Gran labor informativa ğŸ“»", "Sigan adelante con este proyecto! ğŸš€", "Contenido muy bien estructurado ğŸ“Š", "Los recomiendo 100%! ğŸ‘", "Excelente locuciÃ³n y claridad ğŸ¤", "InformaciÃ³n local muy valiosa ğŸ“", "Primera vez que escucho, me gustÃ³! â­", "Ya me suscribÃ­, no me los pierdo! ğŸ“§", "Buena cobertura de noticias ğŸ“¢", "Los amo, mejor radio! â¤ï¸", "Gracias por mantenernos informados ğŸ’™", "Me encanta Radio Click! ğŸ’š", "Contenido de corazÃ³n â¤ï¸â€ğŸ”¥", "Los sigo con mucho cariÃ±o ğŸ§¡", "Hermoso trabajo! ğŸ’–", "Radio con alma ğŸ’›", "Los quiero mucho! ğŸ’œ", "Amor por esta radio ğŸ’•", "De lo mejor! ğŸ’—"];

const emojiOnly = ["ğŸ‘ğŸ‘ğŸ‘", "ğŸ”¥ğŸ”¥", "â¤ï¸â¤ï¸â¤ï¸", "ğŸ‘ğŸ‘", "ğŸ‰ğŸŠ", "ğŸ’ªğŸ’ªğŸ’ª", "â­â­â­â­â­", "ğŸ™Œ", "ğŸ‘ŒğŸ‘Œ", "ğŸ’¯", "ğŸµğŸ¶", "ğŸ“»â¤ï¸", "ğŸ”", "âœ¨âœ¨âœ¨", "ğŸ’™ğŸ’šğŸ’›", "ğŸ¤©", "ğŸ˜ğŸ˜", "ğŸ¥°", "ğŸ‘ğŸ”¥", "ğŸ’–ğŸ’•", "ğŸ¯ğŸ’¯", "ğŸš€ğŸš€", "âš¡âš¡âš¡", "ğŸ’", "ğŸ†", "â¤ï¸â€ğŸ”¥", "ğŸ™ğŸ™", "ğŸ‘ŒğŸ’¯", "ğŸ”¥â¤ï¸", "ğŸŠğŸ‰ğŸŠ"];

let comments = [];
const maxComments = 5;
let lastUsedNames = [];

function addComment() {
  let randomName;
  do {
    randomName = commentNames[Math.floor(Math.random() * commentNames.length)];
  } while (lastUsedNames.includes(randomName));
  
  lastUsedNames.unshift(randomName);
  if (lastUsedNames.length > 5) {
    lastUsedNames.pop();
  }
  
  const isEmojiOnly = Math.random() < 0.25;
  const randomText = isEmojiOnly 
    ? emojiOnly[Math.floor(Math.random() * emojiOnly.length)]
    : commentTexts[Math.floor(Math.random() * commentTexts.length)];
  
  const timeAgo = Math.floor(Math.random() * 5) + 1;
  
  const comment = {
    author: randomName,
    text: randomText,
    time: `Hace ${timeAgo} min`,
    isEmoji: isEmojiOnly
  };
  
  comments.unshift(comment);
  if (comments.length > maxComments) {
    comments.pop();
  }
  
  renderComments();
}

function renderComments() {
  const container = document.getElementById('commentsContainer');
  container.innerHTML = comments.map(c => `
    <div class="comment">
      <div class="comment-author">${c.author}</div>
      <div class="comment-text ${c.isEmoji ? 'emoji-only' : ''}">${c.text}</div>
      <div class="comment-time">${c.time}</div>
    </div>
  `).join('');
}

setTimeout(addComment, 2000);

function scheduleNextComment() {
  const delay = (Math.random() * 15000) + 15000;
  setTimeout(() => {
    addComment();
    scheduleNextComment();
  }, delay);
}

scheduleNextComment();


// COMPARTIR









// COMPARTIR
function shareWhatsApp() {
  const text = encodeURIComponent('ğŸ™ï¸ Escucha Radio Click - MedellÃ­n, Colombia ğŸ“»');
  window.open(`https://wa.me/?text=${text}`, '_blank');
}

function openYouTube() {
  window.open('https://www.youtube.com/@Veracruz-jv9bt/videos', '_blank');
}

// TEMA
function toggleTheme() {
  document.body.classList.toggle('light');
  const icon = document.getElementById('theme-icon');
  icon.textContent = document.body.classList.contains('light') ? 'ğŸŒ™' : 'ğŸ”†';
  localStorage.setItem('theme', document.body.classList.contains('light') ? 'light' : 'dark');
}

if (localStorage.getItem('theme') === 'light') {
  document.body.classList.add('light');
  document.getElementById('theme-icon').textContent = 'ğŸŒ™';
}

// NOTIFICACIÃ“N
function showNotification(message) {
  const notif = document.getElementById('notification');
  notif.textContent = message;
  notif.classList.add('show');
  setTimeout(() => notif.classList.remove('show'), 3000);
}

// EVENT LISTENERS
audio.addEventListener('timeupdate', () => {
  const percent = (audio.currentTime / audio.duration) * 100;
  document.getElementById('progressFill').style.width = percent + '%';
  document.getElementById('currentTime').textContent = formatTime(audio.currentTime);
});

audio.addEventListener('loadedmetadata', () => {
  document.getElementById('duration').textContent = formatTime(audio.duration);
});

audio.addEventListener('ended', () => {
  document.getElementById('playIcon').textContent = 'â–¶ï¸';
});

// INICIALIZAR
initializeCounters();
</script>

</body>
</html>
